var S=Object.defineProperty;var k=(n,e,t)=>e in n?S(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var d=(n,e,t)=>k(n,typeof e!="symbol"?e+"":e,t);import{r as h,j as a,c as f,R as N}from"./client-DZKcGHcG.js";const b={uuid:"note-uuid-empty-spreadsheet-001",title:"New Spreadsheet",text:"",meta:{}},w={uuid:"note-uuid-monthly-budget-002",title:"Monthly Budget",text:"",meta:{}},j={uuid:"note-uuid-inventory-tracker-003",title:"Inventory Tracker",text:"",meta:{}},p=[b,w,j],y={action:"component-registered",sessionKey:"c46be650-73b9-468b-b6b2-d0a4ca1ccc84",componentData:{},data:{uuid:"f43056da-581f-4ee1-8dea-b8dd5ee949ad",environment:"web",platform:"windows-web",activeThemeUrls:[]}},M={item:{uuid:"ec677a63-5fae-440e-84cd-a62ae7c7d894",content_type:"Note",created_at:"2023-03-26T02:01:59.462Z",updated_at:"2023-03-27T00:18:36.199Z",isMetadataUpdate:!1,content:{text:"Hello World",title:"Test",noteType:"unknown",editorIdentifier:"template",references:[],appData:{"org.standardnotes.sn":{client_updated_at:"2023-03-27T00:18:36.483Z"}},spellcheck:!1,preview_plain:" ",preview_html:"<div> </div>"},clientData:{}}};let g={};const x=new Map;class _{constructor(e,t,o=0){d(this,"childWindow");d(this,"streamEvent");d(this,"streamData");d(this,"currentNoteUuid","");this.onSave=t,this.currentNoteUuid=e.uuid,this.updateStream(e),window.addEventListener("message",this.handleMessage.bind(this))}onReady(e){this.childWindow=e,e.postMessage({...y,componentData:g})}toggleLock(e){this.streamData.item.content.appData["org.standardnotes.sn"].locked=e,this.childWindow.postMessage({action:"reply",data:this.streamData,original:this.streamEvent},"*")}toggleTheme(e){const t=e?["dark.css"]:[];this.childWindow.postMessage({action:"themes",data:{themes:t}},"*")}changeData(e,t){this.currentNoteUuid=e.uuid,this.updateStream(e),this.childWindow.postMessage({action:"reply",data:this.streamData,original:this.streamEvent},"*")}handleMessage(e){var o,c,r;const t=e.data;if(t.action==="stream-context-item")this.streamEvent=t,this.childWindow.postMessage({action:"reply",data:this.streamData,original:t},"*");else if(t.action==="save-items"){const i=(c=(o=t.data)==null?void 0:o.items)==null?void 0:c[0];if(((r=i==null?void 0:i.content)==null?void 0:r.text)!==void 0){const l=i.uuid||this.currentNoteUuid;x.set(l,i.content.text),l===this.currentNoteUuid&&(this.streamData.item.content.text=i.content.text)}this.onSave(),this.childWindow.postMessage({action:"reply",data:{},original:t},"*")}else t.action==="set-component-data"&&(g=t.data.componentData)}updateStream(e){this.streamData=JSON.parse(JSON.stringify(M)),this.streamData.item.uuid=e.uuid;const t=x.get(e.uuid);this.streamData.item.content.text=t!==void 0?t:e.text,this.streamData.item.content.appData[this.streamData.item.content.editorIdentifier]=e.meta}}const u=new _(p[0],()=>{const n=document.getElementById("last-saved");n&&(n.textContent=`Last Saved: ${new Date().toLocaleTimeString()}`)},0),R=()=>{const n=h.useRef(null),[e,t]=h.useState(0),[o,c]=h.useState(!1),[r,i]=h.useState("light"),l=s=>{t(s),u.changeData(p[s],s)},D=(s,m)=>a.jsxs("div",{className:e===m?"menu-item selected":"menu-item",onClick:()=>l(m),children:[a.jsx("span",{className:"menu-icon",children:"ðŸ“Š"}),p[m].title]},m),E=s=>{c(s.target.checked),u.toggleLock(s.target.checked)},v=s=>{i(s.target.checked?"dark":"light"),u.toggleTheme(s.target.checked)},T=()=>{var s;u.onReady((s=n.current)==null?void 0:s.contentWindow)};return a.jsxs("div",{className:"demo",children:[a.jsxs("div",{className:"menu",children:[a.jsx("div",{className:"menu-header",children:"Spreadsheets"}),p.map(D)]}),a.jsxs("div",{className:"content",children:[a.jsxs("div",{className:"content-header",children:[a.jsxs("div",{children:[a.jsx("input",{id:"editingDisabled",type:"checkbox",checked:o,onChange:E}),a.jsx("label",{htmlFor:"editingDisabled",children:"Editing Disabled"})]}),a.jsxs("div",{children:[a.jsx("input",{id:"isDark",type:"checkbox",checked:r==="dark",onChange:v}),a.jsx("label",{htmlFor:"isDark",children:"Dark Theme"})]}),a.jsx("div",{id:"last-saved"})]}),a.jsx("iframe",{ref:n,src:"index.html",onLoad:T})]})]})};f.createRoot(document.getElementById("root")).render(a.jsx(N.StrictMode,{children:a.jsx(R,{})}));
